/usr/local/lib/python3.6/dist-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /gdata/liyh/project/e2p/vgg.py:285: calling reduce_mean (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From p2p_att.py:905: get_or_create_global_step (from tensorflow.contrib.framework.python.ops.variables) is deprecated and will be removed in a future version.
Instructions for updating:
Please switch to tf.train.get_or_create_global_step
WARNING:tensorflow:From p2p_att.py:1156: Supervisor.__init__ (from tensorflow.python.training.supervisor) is deprecated and will be removed in a future version.
Instructions for updating:
Please switch to tf.train.MonitoredTrainingSession
2019-02-17 17:40:28.542041: I tensorflow/core/platform/cpu_feature_guard.cc:140] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-02-17 17:40:29.004370: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.62
pciBusID: 0000:09:00.0
totalMemory: 10.92GiB freeMemory: 10.76GiB
2019-02-17 17:40:29.274597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 1 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.62
pciBusID: 0000:08:00.0
totalMemory: 10.92GiB freeMemory: 10.76GiB
2019-02-17 17:40:29.528740: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 2 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.62
pciBusID: 0000:05:00.0
totalMemory: 10.92GiB freeMemory: 10.76GiB
2019-02-17 17:40:29.775085: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 3 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.62
pciBusID: 0000:04:00.0
totalMemory: 10.92GiB freeMemory: 10.76GiB
2019-02-17 17:40:29.782160: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1435] Adding visible gpu devices: 0, 1, 2, 3
2019-02-17 17:40:31.343839: I tensorflow/core/common_runtime/gpu/gpu_device.cc:923] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-02-17 17:40:31.343905: I tensorflow/core/common_runtime/gpu/gpu_device.cc:929]      0 1 2 3 
2019-02-17 17:40:31.343922: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 0:   N Y Y Y 
2019-02-17 17:40:31.343931: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 1:   Y N Y Y 
2019-02-17 17:40:31.343941: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 2:   Y Y N Y 
2019-02-17 17:40:31.343949: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 3:   Y Y Y N 
2019-02-17 17:40:31.345152: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10411 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:09:00.0, compute capability: 6.1)
2019-02-17 17:40:31.347639: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 10411 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080 Ti, pci bus id: 0000:08:00.0, compute capability: 6.1)
2019-02-17 17:40:31.349070: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 10411 MB memory) -> physical GPU (device: 2, name: GeForce GTX 1080 Ti, pci bus id: 0000:05:00.0, compute capability: 6.1)
2019-02-17 17:40:31.350463: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 10411 MB memory) -> physical GPU (device: 3, name: GeForce GTX 1080 Ti, pci bus id: 0000:04:00.0, compute capability: 6.1)
2019-02-17 17:41:18.774922: W tensorflow/core/common_runtime/bfc_allocator.cc:275] Allocator (GPU_2_bfc) ran out of memory trying to allocate 32.00GiB.  Current allocation summary follows.
2019-02-17 17:41:18.775075: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (256): 	Total Chunks: 104, Chunks in use: 104. 26.0KiB allocated for chunks. 26.0KiB in use in bin. 7.8KiB client-requested in use in bin.
2019-02-17 17:41:18.775104: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (512): 	Total Chunks: 19, Chunks in use: 19. 9.5KiB allocated for chunks. 9.5KiB in use in bin. 9.5KiB client-requested in use in bin.
2019-02-17 17:41:18.775128: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (1024): 	Total Chunks: 14, Chunks in use: 14. 14.8KiB allocated for chunks. 14.8KiB in use in bin. 14.0KiB client-requested in use in bin.
2019-02-17 17:41:18.775154: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (2048): 	Total Chunks: 1, Chunks in use: 0. 3.5KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-02-17 17:41:18.775176: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (4096): 	Total Chunks: 1, Chunks in use: 1. 4.5KiB allocated for chunks. 4.5KiB in use in bin. 4.5KiB client-requested in use in bin.
2019-02-17 17:41:18.775201: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (8192): 	Total Chunks: 3, Chunks in use: 2. 36.2KiB allocated for chunks. 21.2KiB in use in bin. 21.2KiB client-requested in use in bin.
2019-02-17 17:41:18.775227: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (16384): 	Total Chunks: 5, Chunks in use: 4. 83.8KiB allocated for chunks. 64.0KiB in use in bin. 64.0KiB client-requested in use in bin.
2019-02-17 17:41:18.775253: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (32768): 	Total Chunks: 5, Chunks in use: 5. 183.8KiB allocated for chunks. 183.8KiB in use in bin. 183.8KiB client-requested in use in bin.
2019-02-17 17:41:18.775312: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-02-17 17:41:18.775335: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (131072): 	Total Chunks: 1, Chunks in use: 0. 165.8KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-02-17 17:41:18.775360: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (262144): 	Total Chunks: 4, Chunks in use: 4. 1.22MiB allocated for chunks. 1.22MiB in use in bin. 1.12MiB client-requested in use in bin.
2019-02-17 17:41:18.775384: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (524288): 	Total Chunks: 1, Chunks in use: 0. 863.5KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-02-17 17:41:18.775407: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (1048576): 	Total Chunks: 3, Chunks in use: 3. 3.55MiB allocated for chunks. 3.55MiB in use in bin. 3.38MiB client-requested in use in bin.
2019-02-17 17:41:18.775431: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (2097152): 	Total Chunks: 4, Chunks in use: 3. 8.88MiB allocated for chunks. 6.00MiB in use in bin. 5.12MiB client-requested in use in bin.
2019-02-17 17:41:18.775453: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-02-17 17:41:18.775473: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (8388608): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-02-17 17:41:18.775497: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (16777216): 	Total Chunks: 3, Chunks in use: 2. 48.00MiB allocated for chunks. 32.00MiB in use in bin. 32.00MiB client-requested in use in bin.
2019-02-17 17:41:18.775523: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (33554432): 	Total Chunks: 5, Chunks in use: 5. 192.00MiB allocated for chunks. 192.00MiB in use in bin. 161.01MiB client-requested in use in bin.
2019-02-17 17:41:18.775546: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (67108864): 	Total Chunks: 1, Chunks in use: 1. 65.00MiB allocated for chunks. 65.00MiB in use in bin. 65.00MiB client-requested in use in bin.
2019-02-17 17:41:18.775568: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-02-17 17:41:18.775591: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (268435456): 	Total Chunks: 4, Chunks in use: 0. 7.44GiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-02-17 17:41:18.775615: I tensorflow/core/common_runtime/bfc_allocator.cc:646] Bin for 32.00GiB was 256.00MiB, Chunk State: 
2019-02-17 17:41:18.775651: I tensorflow/core/common_runtime/bfc_allocator.cc:652]   Size: 447.00MiB | Requested Size: 32.00MiB | in_use: 0, prev:   Size: 65.00MiB | Requested Size: 65.00MiB | in_use: 1
2019-02-17 17:41:18.775677: I tensorflow/core/common_runtime/bfc_allocator.cc:652]   Size: 1.00GiB | Requested Size: 576.00MiB | in_use: 0
2019-02-17 17:41:18.775700: I tensorflow/core/common_runtime/bfc_allocator.cc:652]   Size: 2.00GiB | Requested Size: 1.69GiB | in_use: 0
2019-02-17 17:41:18.775721: I tensorflow/core/common_runtime/bfc_allocator.cc:652]   Size: 4.00GiB | Requested Size: 2.08GiB | in_use: 0
2019-02-17 17:41:18.775747: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Free  at 0x7fe5cfe00000 of size 4294967296
2019-02-17 17:41:18.775766: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Free  at 0x7fe6d4000000 of size 2147483648
2019-02-17 17:41:18.775786: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Free  at 0x7fe754000000 of size 1073741824
2019-02-17 17:41:18.775805: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fe794000000 of size 68161536
2019-02-17 17:41:18.775825: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Free  at 0x7fe798101000 of size 468709376
2019-02-17 17:41:18.775846: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fe7d9c00000 of size 34611200
2019-02-17 17:41:18.775867: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fe7dbd02000 of size 33554432
2019-02-17 17:41:18.775885: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fe7ddd02000 of size 66052096
2019-02-17 17:41:18.775904: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fe7e1c00000 of size 33554432
2019-02-17 17:41:18.775923: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fe7e3c00000 of size 33554432
2019-02-17 17:41:18.775943: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fe7e5c00000 of size 16777216
2019-02-17 17:41:18.775963: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fe7e6c00000 of size 16777216
2019-02-17 17:41:18.775980: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Free  at 0x7fea44600000 of size 16777216
2019-02-17 17:41:18.775998: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7feb43000000 of size 1179648
2019-02-17 17:41:18.776016: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7feb43120000 of size 2097152
2019-02-17 17:41:18.776036: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7feb43320000 of size 2097152
2019-02-17 17:41:18.776056: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Free  at 0x7feb43520000 of size 3014656
2019-02-17 17:41:18.776074: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec44200000 of size 1179648
2019-02-17 17:41:18.776094: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec44320000 of size 512
2019-02-17 17:41:18.776112: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec44320200 of size 294912
2019-02-17 17:41:18.776131: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Free  at 0x7fec44368200 of size 884224
2019-02-17 17:41:18.776150: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec44440000 of size 256
2019-02-17 17:41:18.776169: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec44440100 of size 37632
2019-02-17 17:41:18.776188: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec44449400 of size 9216
2019-02-17 17:41:18.776216: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec4444b800 of size 256
2019-02-17 17:41:18.776235: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec4444b900 of size 256
2019-02-17 17:41:18.776251: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec4444ba00 of size 256
2019-02-17 17:41:18.776280: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec4444bb00 of size 256
2019-02-17 17:41:18.776300: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec4444bc00 of size 256
2019-02-17 17:41:18.776319: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec4444bd00 of size 1024
2019-02-17 17:41:18.776339: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec4444c100 of size 1024
2019-02-17 17:41:18.776355: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec4444c500 of size 1024
2019-02-17 17:41:18.776373: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec4444c900 of size 512
2019-02-17 17:41:18.776392: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec4444cb00 of size 512
2019-02-17 17:41:18.776410: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec4444cd00 of size 512
2019-02-17 17:41:18.776429: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Free  at 0x7fec4444cf00 of size 3584
2019-02-17 17:41:18.776445: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec4444dd00 of size 256
2019-02-17 17:41:18.776463: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec4444de00 of size 256
2019-02-17 17:41:18.776483: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec4444df00 of size 256
2019-02-17 17:41:18.776499: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec4444e000 of size 256
2019-02-17 17:41:18.776517: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec4444e100 of size 256
2019-02-17 17:41:18.776533: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec4444e200 of size 256
2019-02-17 17:41:18.776551: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec4444e300 of size 256
2019-02-17 17:41:18.776571: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec4444e400 of size 256
2019-02-17 17:41:18.776589: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec4444e500 of size 256
2019-02-17 17:41:18.776607: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec4444e600 of size 256
2019-02-17 17:41:18.776623: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec4444e700 of size 512
2019-02-17 17:41:18.776641: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec4444e900 of size 256
2019-02-17 17:41:18.776659: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec4444ea00 of size 256
2019-02-17 17:41:18.776678: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Free  at 0x7fec4444eb00 of size 15360
2019-02-17 17:41:18.776696: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec44452700 of size 12544
2019-02-17 17:41:18.776723: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec44455800 of size 37632
2019-02-17 17:41:18.776740: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Free  at 0x7fec4445eb00 of size 169728
2019-02-17 17:41:18.776758: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec44488200 of size 256
2019-02-17 17:41:18.776774: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec44488300 of size 256
2019-02-17 17:41:18.776791: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec44488400 of size 256
2019-02-17 17:41:18.776807: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec44488500 of size 37632
2019-02-17 17:41:18.776824: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec44491800 of size 37632
2019-02-17 17:41:18.776844: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec4449ab00 of size 512
2019-02-17 17:41:18.776863: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec4449ad00 of size 512
2019-02-17 17:41:18.776881: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec4449af00 of size 512
2019-02-17 17:41:18.776900: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec4449b100 of size 512
2019-02-17 17:41:18.776919: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec4449b300 of size 512
2019-02-17 17:41:18.776938: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec4449b500 of size 512
2019-02-17 17:41:18.776957: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec4449b700 of size 256
2019-02-17 17:41:18.776974: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec4449b800 of size 256
2019-02-17 17:41:18.776990: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec4449b900 of size 1024
2019-02-17 17:41:18.777008: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec4449bd00 of size 16384
2019-02-17 17:41:18.777026: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Free  at 0x7fec4449fd00 of size 20224
2019-02-17 17:41:18.777042: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444a4c00 of size 256
2019-02-17 17:41:18.777062: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444a4d00 of size 256
2019-02-17 17:41:18.777080: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444a4e00 of size 256
2019-02-17 17:41:18.777096: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444a4f00 of size 256
2019-02-17 17:41:18.777114: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444a5000 of size 256
2019-02-17 17:41:18.777130: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444a5100 of size 256
2019-02-17 17:41:18.777148: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444a5200 of size 256
2019-02-17 17:41:18.777169: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444a5300 of size 1024
2019-02-17 17:41:18.777187: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444a5700 of size 1024
2019-02-17 17:41:18.777206: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444a5b00 of size 256
2019-02-17 17:41:18.777223: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444a5c00 of size 1024
2019-02-17 17:41:18.777241: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444a6000 of size 256
2019-02-17 17:41:18.777267: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444a6100 of size 256
2019-02-17 17:41:18.777284: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444a6200 of size 256
2019-02-17 17:41:18.777302: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444a6300 of size 1024
2019-02-17 17:41:18.777318: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444a6700 of size 1024
2019-02-17 17:41:18.777336: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444a6b00 of size 256
2019-02-17 17:41:18.777355: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444a6c00 of size 256
2019-02-17 17:41:18.777371: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444a6d00 of size 256
2019-02-17 17:41:18.777389: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444a6e00 of size 256
2019-02-17 17:41:18.777405: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444a6f00 of size 256
2019-02-17 17:41:18.777425: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444a7000 of size 256
2019-02-17 17:41:18.777443: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444a7100 of size 256
2019-02-17 17:41:18.777458: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444a7200 of size 256
2019-02-17 17:41:18.777476: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444a7300 of size 256
2019-02-17 17:41:18.777496: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444a7400 of size 256
2019-02-17 17:41:18.777515: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444a7500 of size 256
2019-02-17 17:41:18.777533: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444a7600 of size 256
2019-02-17 17:41:18.777549: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444a7700 of size 16384
2019-02-17 17:41:18.777567: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444ab700 of size 16384
2019-02-17 17:41:18.777587: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444af700 of size 256
2019-02-17 17:41:18.777606: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444af800 of size 256
2019-02-17 17:41:18.777624: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444af900 of size 256
2019-02-17 17:41:18.777640: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444afa00 of size 256
2019-02-17 17:41:18.777658: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444afb00 of size 256
2019-02-17 17:41:18.777676: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444afc00 of size 256
2019-02-17 17:41:18.777692: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444afd00 of size 256
2019-02-17 17:41:18.777712: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444afe00 of size 256
2019-02-17 17:41:18.777727: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444aff00 of size 256
2019-02-17 17:41:18.777745: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b0000 of size 256
2019-02-17 17:41:18.777764: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b0100 of size 256
2019-02-17 17:41:18.777782: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b0200 of size 256
2019-02-17 17:41:18.777801: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b0300 of size 256
2019-02-17 17:41:18.777816: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b0400 of size 256
2019-02-17 17:41:18.777835: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b0500 of size 4608
2019-02-17 17:41:18.777854: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b1700 of size 256
2019-02-17 17:41:18.777872: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b1800 of size 256
2019-02-17 17:41:18.777890: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b1900 of size 256
2019-02-17 17:41:18.777906: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b1a00 of size 256
2019-02-17 17:41:18.777924: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b1b00 of size 256
2019-02-17 17:41:18.777940: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b1c00 of size 256
2019-02-17 17:41:18.777956: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b1d00 of size 256
2019-02-17 17:41:18.777972: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b1e00 of size 256
2019-02-17 17:41:18.777990: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b1f00 of size 256
2019-02-17 17:41:18.778010: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b2000 of size 256
2019-02-17 17:41:18.778028: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b2100 of size 256
2019-02-17 17:41:18.778046: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b2200 of size 512
2019-02-17 17:41:18.778064: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b2400 of size 256
2019-02-17 17:41:18.778083: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b2500 of size 256
2019-02-17 17:41:18.778101: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b2600 of size 256
2019-02-17 17:41:18.778120: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b2700 of size 256
2019-02-17 17:41:18.778139: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b2800 of size 256
2019-02-17 17:41:18.778159: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b2900 of size 256
2019-02-17 17:41:18.778177: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b2a00 of size 256
2019-02-17 17:41:18.778195: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b2b00 of size 256
2019-02-17 17:41:18.778214: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b2c00 of size 256
2019-02-17 17:41:18.778234: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b2d00 of size 256
2019-02-17 17:41:18.778252: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b2e00 of size 1024
2019-02-17 17:41:18.778277: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b3200 of size 1536
2019-02-17 17:41:18.778296: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b3800 of size 512
2019-02-17 17:41:18.778314: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b3a00 of size 512
2019-02-17 17:41:18.778334: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b3c00 of size 512
2019-02-17 17:41:18.778353: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b3e00 of size 256
2019-02-17 17:41:18.778372: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fec444b3f00 of size 1360128
2019-02-17 17:41:18.778392: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fecd0200000 of size 2097152
2019-02-17 17:41:18.778412: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fed0c200000 of size 1280
2019-02-17 17:41:18.778431: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fed0c200500 of size 256
2019-02-17 17:41:18.778450: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fed0c200600 of size 256
2019-02-17 17:41:18.778466: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fed0c200700 of size 256
2019-02-17 17:41:18.778484: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fed0c200800 of size 256
2019-02-17 17:41:18.778502: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fed0c200900 of size 1024
2019-02-17 17:41:18.778520: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fed0c200d00 of size 256
2019-02-17 17:41:18.778538: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fed0c200e00 of size 256
2019-02-17 17:41:18.778558: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fed0c200f00 of size 1024
2019-02-17 17:41:18.778577: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fed0c201300 of size 256
2019-02-17 17:41:18.778597: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fed0c201400 of size 256
2019-02-17 17:41:18.778615: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fed0c201500 of size 256
2019-02-17 17:41:18.778633: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fed0c201600 of size 16384
2019-02-17 17:41:18.778652: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fed0c205600 of size 256
2019-02-17 17:41:18.778669: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fed0c205700 of size 512
2019-02-17 17:41:18.778688: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fed0c205900 of size 256
2019-02-17 17:41:18.778707: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fed0c205a00 of size 256
2019-02-17 17:41:18.778723: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fed0c205b00 of size 256
2019-02-17 17:41:18.778741: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fed0c205c00 of size 294912
2019-02-17 17:41:18.778760: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fed0c24dc00 of size 256
2019-02-17 17:41:18.778777: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fed0c24dd00 of size 256
2019-02-17 17:41:18.778795: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fed0c24de00 of size 256
2019-02-17 17:41:18.778811: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fed0c24df00 of size 37632
2019-02-17 17:41:18.778829: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fed0c257200 of size 512
2019-02-17 17:41:18.778847: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fed0c257400 of size 512
2019-02-17 17:41:18.778866: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fed0c257600 of size 512
2019-02-17 17:41:18.778882: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fed0c257800 of size 256
2019-02-17 17:41:18.778902: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fed0c257900 of size 256
2019-02-17 17:41:18.778920: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fed0c257a00 of size 256
2019-02-17 17:41:18.778938: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fed0c257b00 of size 256
2019-02-17 17:41:18.778954: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fed0c257c00 of size 256
2019-02-17 17:41:18.778972: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fed0c257d00 of size 256
2019-02-17 17:41:18.778988: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fed0c257e00 of size 294912
2019-02-17 17:41:18.779007: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fed0c29fe00 of size 393728
2019-02-17 17:41:18.779025: I tensorflow/core/common_runtime/bfc_allocator.cc:671]      Summary of in-use Chunks by size: 
2019-02-17 17:41:18.779048: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 104 Chunks of size 256 totalling 26.0KiB
2019-02-17 17:41:18.779068: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 19 Chunks of size 512 totalling 9.5KiB
2019-02-17 17:41:18.779090: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 12 Chunks of size 1024 totalling 12.0KiB
2019-02-17 17:41:18.779111: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 1 Chunks of size 1280 totalling 1.2KiB
2019-02-17 17:41:18.779131: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 1 Chunks of size 1536 totalling 1.5KiB
2019-02-17 17:41:18.779151: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 1 Chunks of size 4608 totalling 4.5KiB
2019-02-17 17:41:18.779170: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 1 Chunks of size 9216 totalling 9.0KiB
2019-02-17 17:41:18.779190: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 1 Chunks of size 12544 totalling 12.2KiB
2019-02-17 17:41:18.779211: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 4 Chunks of size 16384 totalling 64.0KiB
2019-02-17 17:41:18.779231: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 5 Chunks of size 37632 totalling 183.8KiB
2019-02-17 17:41:18.779251: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 3 Chunks of size 294912 totalling 864.0KiB
2019-02-17 17:41:18.779281: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 1 Chunks of size 393728 totalling 384.5KiB
2019-02-17 17:41:18.779301: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 2 Chunks of size 1179648 totalling 2.25MiB
2019-02-17 17:41:18.779322: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 1 Chunks of size 1360128 totalling 1.30MiB
2019-02-17 17:41:18.779342: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 3 Chunks of size 2097152 totalling 6.00MiB
2019-02-17 17:41:18.779361: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 2 Chunks of size 16777216 totalling 32.00MiB
2019-02-17 17:41:18.779381: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 3 Chunks of size 33554432 totalling 96.00MiB
2019-02-17 17:41:18.779400: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 1 Chunks of size 34611200 totalling 33.01MiB
2019-02-17 17:41:18.779421: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 1 Chunks of size 66052096 totalling 62.99MiB
2019-02-17 17:41:18.779442: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 1 Chunks of size 68161536 totalling 65.00MiB
2019-02-17 17:41:18.779463: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Sum Total of in-use chunks: 300.09MiB
2019-02-17 17:41:18.779489: I tensorflow/core/common_runtime/bfc_allocator.cc:680] Stats: 
Limit:                 10917337498
InUse:                   314663424
MaxInUse:               2582638848
NumAllocs:                     250
MaxAllocSize:           2233466880

2019-02-17 17:41:18.779531: W tensorflow/core/common_runtime/bfc_allocator.cc:279] __________________________________________________________________________________________**____****
2019-02-17 17:41:18.779603: W tensorflow/core/framework/op_kernel.cc:1318] OP_REQUIRES failed at batch_matmul_op_impl.h:489 : Resource exhausted: OOM when allocating tensor with shape[2,65536,65536] and type float on /job:localhost/replica:0/task:0/device:GPU:2 by allocator GPU_2_bfc
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py", line 1322, in _do_call
    return fn(*args)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py", line 1307, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py", line 1409, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[2,65536,65536] and type float on /job:localhost/replica:0/task:0/device:GPU:2 by allocator GPU_2_bfc
	 [[Node: generator/decoder/attention_1/MatMul = BatchMatMul[T=DT_FLOAT, _class=["loc:@gener...d/MatMul_1"], adj_x=false, adj_y=true, _device="/job:localhost/replica:0/task:0/device:GPU:2"](generator/decoder/attention_1/Reshape, generator/decoder/attention_1/Reshape_1, ^swap_out_generator_train/gradients/generator/decoder/attention_1/MatMul_grad/MatMul_1, ^swap_out_generator_train/gradients/generator/decoder/attention_1/MatMul_grad/MatMul_1_1)]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.

	 [[Node: generator_train/Adam/beta1/_977 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:GPU:1", send_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device_incarnation=1, tensor_name="edge_8815_generator_train/Adam/beta1", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/device:GPU:1"]()]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "p2p_att.py", line 1272, in <module>
    main()
  File "p2p_att.py", line 1232, in main
    results = sess.run(fetches, options=options, run_metadata=run_metadata)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py", line 900, in run
    run_metadata_ptr)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py", line 1135, in _run
    feed_dict_tensor, options, run_metadata)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py", line 1316, in _do_run
    run_metadata)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py", line 1335, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[2,65536,65536] and type float on /job:localhost/replica:0/task:0/device:GPU:2 by allocator GPU_2_bfc
	 [[Node: generator/decoder/attention_1/MatMul = BatchMatMul[T=DT_FLOAT, _class=["loc:@gener...d/MatMul_1"], adj_x=false, adj_y=true, _device="/job:localhost/replica:0/task:0/device:GPU:2"](generator/decoder/attention_1/Reshape, generator/decoder/attention_1/Reshape_1, ^swap_out_generator_train/gradients/generator/decoder/attention_1/MatMul_grad/MatMul_1, ^swap_out_generator_train/gradients/generator/decoder/attention_1/MatMul_grad/MatMul_1_1)]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.

	 [[Node: generator_train/Adam/beta1/_977 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:GPU:1", send_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device_incarnation=1, tensor_name="edge_8815_generator_train/Adam/beta1", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/device:GPU:1"]()]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.


Caused by op 'generator/decoder/attention_1/MatMul', defined at:
  File "p2p_att.py", line 1272, in <module>
    main()
  File "p2p_att.py", line 1084, in main
    model = create_model(examples.inputs, examples.targets)
  File "p2p_att.py", line 820, in create_model
    outputs = create_generator_resgan(inputs, out_channels)
  File "p2p_att.py", line 313, in create_generator_resgan
    input_channel=a.ngf, flag_condition=False, channel_fac=a.channel_fac, scope='attention_1')
  File "/gdata/liyh/project/e2p/ops.py", line 112, in selfatt
    s = tf.matmul(hw_flatten(g), hw_flatten(f), transpose_b=True) # # [bs, N, N]
  File "/usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/math_ops.py", line 2084, in matmul
    a, b, adj_x=adjoint_a, adj_y=adjoint_b, name=name)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/gen_math_ops.py", line 1236, in batch_mat_mul
    "BatchMatMul", x=x, y=y, adj_x=adj_x, adj_y=adj_y, name=name)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/ops.py", line 3392, in create_op
    op_def=op_def)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/ops.py", line 1718, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

ResourceExhaustedError (see above for traceback): OOM when allocating tensor with shape[2,65536,65536] and type float on /job:localhost/replica:0/task:0/device:GPU:2 by allocator GPU_2_bfc
	 [[Node: generator/decoder/attention_1/MatMul = BatchMatMul[T=DT_FLOAT, _class=["loc:@gener...d/MatMul_1"], adj_x=false, adj_y=true, _device="/job:localhost/replica:0/task:0/device:GPU:2"](generator/decoder/attention_1/Reshape, generator/decoder/attention_1/Reshape_1, ^swap_out_generator_train/gradients/generator/decoder/attention_1/MatMul_grad/MatMul_1, ^swap_out_generator_train/gradients/generator/decoder/attention_1/MatMul_grad/MatMul_1_1)]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.

	 [[Node: generator_train/Adam/beta1/_977 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:GPU:1", send_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device_incarnation=1, tensor_name="edge_8815_generator_train/Adam/beta1", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/device:GPU:1"]()]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.


/usr/local/lib/python3.6/dist-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /gdata/liyh/project/e2p/vgg.py:285: calling reduce_mean (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From p2p_att.py:905: get_or_create_global_step (from tensorflow.contrib.framework.python.ops.variables) is deprecated and will be removed in a future version.
Instructions for updating:
Please switch to tf.train.get_or_create_global_step
WARNING:tensorflow:From p2p_att.py:1156: Supervisor.__init__ (from tensorflow.python.training.supervisor) is deprecated and will be removed in a future version.
Instructions for updating:
Please switch to tf.train.MonitoredTrainingSession
2019-02-18 15:36:19.911917: I tensorflow/core/platform/cpu_feature_guard.cc:140] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-02-18 15:36:20.346789: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.62
pciBusID: 0000:8a:00.0
totalMemory: 10.92GiB freeMemory: 10.76GiB
2019-02-18 15:36:20.669847: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 1 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.62
pciBusID: 0000:89:00.0
totalMemory: 10.92GiB freeMemory: 10.76GiB
2019-02-18 15:36:20.961221: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 2 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.62
pciBusID: 0000:86:00.0
totalMemory: 10.92GiB freeMemory: 10.76GiB
2019-02-18 15:36:21.221055: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 3 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.62
pciBusID: 0000:85:00.0
totalMemory: 10.92GiB freeMemory: 10.76GiB
2019-02-18 15:36:21.229786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1435] Adding visible gpu devices: 0, 1, 2, 3
2019-02-18 15:36:24.190302: I tensorflow/core/common_runtime/gpu/gpu_device.cc:923] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-02-18 15:36:24.190363: I tensorflow/core/common_runtime/gpu/gpu_device.cc:929]      0 1 2 3 
2019-02-18 15:36:24.190378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 0:   N Y Y Y 
2019-02-18 15:36:24.190388: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 1:   Y N Y Y 
2019-02-18 15:36:24.190396: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 2:   Y Y N Y 
2019-02-18 15:36:24.190405: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 3:   Y Y Y N 
2019-02-18 15:36:24.194248: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10411 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:8a:00.0, compute capability: 6.1)
2019-02-18 15:36:24.196739: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 10411 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080 Ti, pci bus id: 0000:89:00.0, compute capability: 6.1)
2019-02-18 15:36:24.197987: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 10411 MB memory) -> physical GPU (device: 2, name: GeForce GTX 1080 Ti, pci bus id: 0000:86:00.0, compute capability: 6.1)
2019-02-18 15:36:24.199239: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 10411 MB memory) -> physical GPU (device: 3, name: GeForce GTX 1080 Ti, pci bus id: 0000:85:00.0, compute capability: 6.1)
2019-02-18 15:37:12.023040: W tensorflow/core/common_runtime/bfc_allocator.cc:275] Allocator (GPU_2_bfc) ran out of memory trying to allocate 32.00GiB.  Current allocation summary follows.
2019-02-18 15:37:12.023236: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (256): 	Total Chunks: 104, Chunks in use: 104. 26.0KiB allocated for chunks. 26.0KiB in use in bin. 7.8KiB client-requested in use in bin.
2019-02-18 15:37:12.023265: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (512): 	Total Chunks: 19, Chunks in use: 19. 9.8KiB allocated for chunks. 9.8KiB in use in bin. 9.5KiB client-requested in use in bin.
2019-02-18 15:37:12.023291: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (1024): 	Total Chunks: 14, Chunks in use: 14. 14.2KiB allocated for chunks. 14.2KiB in use in bin. 14.0KiB client-requested in use in bin.
2019-02-18 15:37:12.023314: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (2048): 	Total Chunks: 1, Chunks in use: 0. 3.0KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-02-18 15:37:12.023341: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (4096): 	Total Chunks: 1, Chunks in use: 1. 4.5KiB allocated for chunks. 4.5KiB in use in bin. 4.5KiB client-requested in use in bin.
2019-02-18 15:37:12.023365: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (8192): 	Total Chunks: 3, Chunks in use: 2. 37.0KiB allocated for chunks. 21.2KiB in use in bin. 21.2KiB client-requested in use in bin.
2019-02-18 15:37:12.023388: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (16384): 	Total Chunks: 5, Chunks in use: 4. 83.8KiB allocated for chunks. 64.0KiB in use in bin. 64.0KiB client-requested in use in bin.
2019-02-18 15:37:12.023411: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (32768): 	Total Chunks: 5, Chunks in use: 5. 183.8KiB allocated for chunks. 183.8KiB in use in bin. 183.8KiB client-requested in use in bin.
2019-02-18 15:37:12.023433: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-02-18 15:37:12.023453: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (131072): 	Total Chunks: 1, Chunks in use: 0. 165.8KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-02-18 15:37:12.023476: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (262144): 	Total Chunks: 4, Chunks in use: 4. 1.22MiB allocated for chunks. 1.22MiB in use in bin. 1.12MiB client-requested in use in bin.
2019-02-18 15:37:12.023496: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (524288): 	Total Chunks: 1, Chunks in use: 0. 863.5KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-02-18 15:37:12.023518: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (1048576): 	Total Chunks: 3, Chunks in use: 3. 3.55MiB allocated for chunks. 3.55MiB in use in bin. 3.38MiB client-requested in use in bin.
2019-02-18 15:37:12.023540: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (2097152): 	Total Chunks: 4, Chunks in use: 3. 8.88MiB allocated for chunks. 6.00MiB in use in bin. 5.12MiB client-requested in use in bin.
2019-02-18 15:37:12.023561: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-02-18 15:37:12.023581: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (8388608): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-02-18 15:37:12.023605: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (16777216): 	Total Chunks: 3, Chunks in use: 2. 48.00MiB allocated for chunks. 32.00MiB in use in bin. 32.00MiB client-requested in use in bin.
2019-02-18 15:37:12.023626: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (33554432): 	Total Chunks: 5, Chunks in use: 5. 192.00MiB allocated for chunks. 192.00MiB in use in bin. 161.01MiB client-requested in use in bin.
2019-02-18 15:37:12.023647: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (67108864): 	Total Chunks: 1, Chunks in use: 1. 65.00MiB allocated for chunks. 65.00MiB in use in bin. 65.00MiB client-requested in use in bin.
2019-02-18 15:37:12.023668: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-02-18 15:37:12.023689: I tensorflow/core/common_runtime/bfc_allocator.cc:630] Bin (268435456): 	Total Chunks: 4, Chunks in use: 0. 7.44GiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2019-02-18 15:37:12.023711: I tensorflow/core/common_runtime/bfc_allocator.cc:646] Bin for 32.00GiB was 256.00MiB, Chunk State: 
2019-02-18 15:37:12.023744: I tensorflow/core/common_runtime/bfc_allocator.cc:652]   Size: 447.00MiB | Requested Size: 32.00MiB | in_use: 0, prev:   Size: 65.00MiB | Requested Size: 65.00MiB | in_use: 1
2019-02-18 15:37:12.023767: I tensorflow/core/common_runtime/bfc_allocator.cc:652]   Size: 1.00GiB | Requested Size: 576.00MiB | in_use: 0
2019-02-18 15:37:12.023789: I tensorflow/core/common_runtime/bfc_allocator.cc:652]   Size: 2.00GiB | Requested Size: 1.69GiB | in_use: 0
2019-02-18 15:37:12.023810: I tensorflow/core/common_runtime/bfc_allocator.cc:652]   Size: 4.00GiB | Requested Size: 2.08GiB | in_use: 0
2019-02-18 15:37:12.023836: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Free  at 0x7fb693e00000 of size 4294967296
2019-02-18 15:37:12.023858: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Free  at 0x7fb798000000 of size 2147483648
2019-02-18 15:37:12.023875: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Free  at 0x7fb818000000 of size 1073741824
2019-02-18 15:37:12.023898: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fb858000000 of size 68161536
2019-02-18 15:37:12.023916: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Free  at 0x7fb85c101000 of size 468709376
2019-02-18 15:37:12.023936: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fb89fc00000 of size 34611200
2019-02-18 15:37:12.023955: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fb8a1d02000 of size 33554432
2019-02-18 15:37:12.023975: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fb8a3d02000 of size 66052096
2019-02-18 15:37:12.023991: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fb8a7c00000 of size 33554432
2019-02-18 15:37:12.024006: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fb8a9c00000 of size 33554432
2019-02-18 15:37:12.024025: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbad2000000 of size 16777216
2019-02-18 15:37:12.024044: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbad3000000 of size 16777216
2019-02-18 15:37:12.024062: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Free  at 0x7fbb10800000 of size 16777216
2019-02-18 15:37:12.024079: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbbdf800000 of size 1179648
2019-02-18 15:37:12.024097: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbbdf920000 of size 2097152
2019-02-18 15:37:12.024116: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbbdfb20000 of size 2097152
2019-02-18 15:37:12.024135: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Free  at 0x7fbbdfd20000 of size 3014656
2019-02-18 15:37:12.024153: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce0200000 of size 1179648
2019-02-18 15:37:12.024179: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce0320000 of size 512
2019-02-18 15:37:12.024200: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce0320200 of size 294912
2019-02-18 15:37:12.024217: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Free  at 0x7fbce0368200 of size 884224
2019-02-18 15:37:12.024233: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce0440000 of size 256
2019-02-18 15:37:12.024250: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce0440100 of size 37632
2019-02-18 15:37:12.024266: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce0449400 of size 9216
2019-02-18 15:37:12.024281: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce044b800 of size 256
2019-02-18 15:37:12.024297: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce044b900 of size 1024
2019-02-18 15:37:12.024313: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce044bd00 of size 1024
2019-02-18 15:37:12.024328: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce044c100 of size 1024
2019-02-18 15:37:12.024343: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce044c500 of size 1024
2019-02-18 15:37:12.024359: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce044c900 of size 1024
2019-02-18 15:37:12.024374: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce044cd00 of size 512
2019-02-18 15:37:12.024390: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce044cf00 of size 512
2019-02-18 15:37:12.024408: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Free  at 0x7fbce044d100 of size 3072
2019-02-18 15:37:12.024426: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce044dd00 of size 256
2019-02-18 15:37:12.024446: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce044de00 of size 256
2019-02-18 15:37:12.024473: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce044df00 of size 256
2019-02-18 15:37:12.024488: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce044e000 of size 256
2019-02-18 15:37:12.024506: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce044e100 of size 256
2019-02-18 15:37:12.024524: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce044e200 of size 256
2019-02-18 15:37:12.024542: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce044e300 of size 256
2019-02-18 15:37:12.024559: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce044e400 of size 256
2019-02-18 15:37:12.024575: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce044e500 of size 256
2019-02-18 15:37:12.024593: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce044e600 of size 512
2019-02-18 15:37:12.024612: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Free  at 0x7fbce044e800 of size 16128
2019-02-18 15:37:12.024632: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce0452700 of size 12544
2019-02-18 15:37:12.024650: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce0455800 of size 37632
2019-02-18 15:37:12.024665: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Free  at 0x7fbce045eb00 of size 169728
2019-02-18 15:37:12.024683: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce0488200 of size 256
2019-02-18 15:37:12.024702: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce0488300 of size 256
2019-02-18 15:37:12.024721: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce0488400 of size 256
2019-02-18 15:37:12.024741: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce0488500 of size 37632
2019-02-18 15:37:12.024756: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce0491800 of size 37632
2019-02-18 15:37:12.024774: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce049ab00 of size 512
2019-02-18 15:37:12.024792: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce049ad00 of size 512
2019-02-18 15:37:12.024808: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce049af00 of size 512
2019-02-18 15:37:12.024825: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce049b100 of size 512
2019-02-18 15:37:12.024843: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce049b300 of size 512
2019-02-18 15:37:12.024862: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce049b500 of size 512
2019-02-18 15:37:12.024880: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce049b700 of size 256
2019-02-18 15:37:12.024898: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce049b800 of size 256
2019-02-18 15:37:12.024917: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce049b900 of size 1024
2019-02-18 15:37:12.024935: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce049bd00 of size 16384
2019-02-18 15:37:12.024953: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Free  at 0x7fbce049fd00 of size 20224
2019-02-18 15:37:12.024972: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04a4c00 of size 256
2019-02-18 15:37:12.024990: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04a4d00 of size 256
2019-02-18 15:37:12.025009: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04a4e00 of size 256
2019-02-18 15:37:12.025026: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04a4f00 of size 256
2019-02-18 15:37:12.025042: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04a5000 of size 256
2019-02-18 15:37:12.025060: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04a5100 of size 256
2019-02-18 15:37:12.025075: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04a5200 of size 256
2019-02-18 15:37:12.025091: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04a5300 of size 1024
2019-02-18 15:37:12.025111: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04a5700 of size 1024
2019-02-18 15:37:12.025129: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04a5b00 of size 256
2019-02-18 15:37:12.025144: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04a5c00 of size 1024
2019-02-18 15:37:12.025162: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04a6000 of size 256
2019-02-18 15:37:12.025187: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04a6100 of size 256
2019-02-18 15:37:12.025204: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04a6200 of size 256
2019-02-18 15:37:12.025220: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04a6300 of size 1024
2019-02-18 15:37:12.025235: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04a6700 of size 1024
2019-02-18 15:37:12.025255: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04a6b00 of size 256
2019-02-18 15:37:12.025270: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04a6c00 of size 256
2019-02-18 15:37:12.025288: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04a6d00 of size 256
2019-02-18 15:37:12.025308: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04a6e00 of size 256
2019-02-18 15:37:12.025326: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04a6f00 of size 256
2019-02-18 15:37:12.025345: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04a7000 of size 256
2019-02-18 15:37:12.025361: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04a7100 of size 256
2019-02-18 15:37:12.025378: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04a7200 of size 256
2019-02-18 15:37:12.025396: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04a7300 of size 256
2019-02-18 15:37:12.025412: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04a7400 of size 256
2019-02-18 15:37:12.025430: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04a7500 of size 256
2019-02-18 15:37:12.025446: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04a7600 of size 256
2019-02-18 15:37:12.025463: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04a7700 of size 16384
2019-02-18 15:37:12.025481: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04ab700 of size 16384
2019-02-18 15:37:12.025499: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04af700 of size 256
2019-02-18 15:37:12.025514: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04af800 of size 256
2019-02-18 15:37:12.025532: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04af900 of size 256
2019-02-18 15:37:12.025548: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04afa00 of size 256
2019-02-18 15:37:12.025563: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04afb00 of size 256
2019-02-18 15:37:12.025579: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04afc00 of size 256
2019-02-18 15:37:12.025594: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04afd00 of size 256
2019-02-18 15:37:12.025610: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04afe00 of size 256
2019-02-18 15:37:12.025627: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04aff00 of size 256
2019-02-18 15:37:12.025646: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b0000 of size 256
2019-02-18 15:37:12.025666: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b0100 of size 256
2019-02-18 15:37:12.025685: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b0200 of size 256
2019-02-18 15:37:12.025700: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b0300 of size 256
2019-02-18 15:37:12.025718: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b0400 of size 256
2019-02-18 15:37:12.025738: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b0500 of size 4608
2019-02-18 15:37:12.025756: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b1700 of size 256
2019-02-18 15:37:12.025771: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b1800 of size 256
2019-02-18 15:37:12.025790: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b1900 of size 256
2019-02-18 15:37:12.025808: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b1a00 of size 256
2019-02-18 15:37:12.025828: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b1b00 of size 256
2019-02-18 15:37:12.025846: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b1c00 of size 256
2019-02-18 15:37:12.025863: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b1d00 of size 256
2019-02-18 15:37:12.025882: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b1e00 of size 256
2019-02-18 15:37:12.025901: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b1f00 of size 256
2019-02-18 15:37:12.025918: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b2000 of size 256
2019-02-18 15:37:12.025936: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b2100 of size 256
2019-02-18 15:37:12.025951: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b2200 of size 256
2019-02-18 15:37:12.025968: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b2300 of size 256
2019-02-18 15:37:12.025986: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b2400 of size 256
2019-02-18 15:37:12.026003: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b2500 of size 256
2019-02-18 15:37:12.026019: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b2600 of size 256
2019-02-18 15:37:12.026037: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b2700 of size 512
2019-02-18 15:37:12.026055: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b2900 of size 256
2019-02-18 15:37:12.026074: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b2a00 of size 256
2019-02-18 15:37:12.026092: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b2b00 of size 256
2019-02-18 15:37:12.026108: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b2c00 of size 256
2019-02-18 15:37:12.026124: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b2d00 of size 256
2019-02-18 15:37:12.026143: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b2e00 of size 256
2019-02-18 15:37:12.026161: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b2f00 of size 256
2019-02-18 15:37:12.026185: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b3000 of size 256
2019-02-18 15:37:12.026201: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b3100 of size 256
2019-02-18 15:37:12.026218: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b3200 of size 256
2019-02-18 15:37:12.026233: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b3300 of size 256
2019-02-18 15:37:12.026249: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b3400 of size 256
2019-02-18 15:37:12.026264: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b3500 of size 768
2019-02-18 15:37:12.026280: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b3800 of size 512
2019-02-18 15:37:12.026298: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b3a00 of size 512
2019-02-18 15:37:12.026317: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b3c00 of size 512
2019-02-18 15:37:12.026335: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b3e00 of size 256
2019-02-18 15:37:12.026350: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbce04b3f00 of size 1360128
2019-02-18 15:37:12.026369: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbd94400000 of size 2097152
2019-02-18 15:37:12.026385: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbdc1c00000 of size 1280
2019-02-18 15:37:12.026403: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbdc1c00500 of size 256
2019-02-18 15:37:12.026423: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbdc1c00600 of size 256
2019-02-18 15:37:12.026439: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbdc1c00700 of size 256
2019-02-18 15:37:12.026454: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbdc1c00800 of size 256
2019-02-18 15:37:12.026473: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbdc1c00900 of size 1024
2019-02-18 15:37:12.026492: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbdc1c00d00 of size 256
2019-02-18 15:37:12.026510: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbdc1c00e00 of size 256
2019-02-18 15:37:12.026526: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbdc1c00f00 of size 1024
2019-02-18 15:37:12.026544: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbdc1c01300 of size 256
2019-02-18 15:37:12.026562: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbdc1c01400 of size 256
2019-02-18 15:37:12.026577: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbdc1c01500 of size 256
2019-02-18 15:37:12.026595: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbdc1c01600 of size 16384
2019-02-18 15:37:12.026611: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbdc1c05600 of size 256
2019-02-18 15:37:12.026628: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbdc1c05700 of size 512
2019-02-18 15:37:12.026648: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbdc1c05900 of size 256
2019-02-18 15:37:12.026666: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbdc1c05a00 of size 256
2019-02-18 15:37:12.026685: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbdc1c05b00 of size 256
2019-02-18 15:37:12.026703: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbdc1c05c00 of size 294912
2019-02-18 15:37:12.026722: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbdc1c4dc00 of size 256
2019-02-18 15:37:12.026742: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbdc1c4dd00 of size 256
2019-02-18 15:37:12.026761: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbdc1c4de00 of size 256
2019-02-18 15:37:12.026776: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbdc1c4df00 of size 37632
2019-02-18 15:37:12.026794: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbdc1c57200 of size 512
2019-02-18 15:37:12.026809: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbdc1c57400 of size 512
2019-02-18 15:37:12.026827: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbdc1c57600 of size 512
2019-02-18 15:37:12.026846: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbdc1c57800 of size 256
2019-02-18 15:37:12.026861: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbdc1c57900 of size 256
2019-02-18 15:37:12.026879: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbdc1c57a00 of size 256
2019-02-18 15:37:12.026894: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbdc1c57b00 of size 256
2019-02-18 15:37:12.026911: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbdc1c57c00 of size 256
2019-02-18 15:37:12.026926: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbdc1c57d00 of size 256
2019-02-18 15:37:12.026944: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbdc1c57e00 of size 294912
2019-02-18 15:37:12.026962: I tensorflow/core/common_runtime/bfc_allocator.cc:665] Chunk at 0x7fbdc1c9fe00 of size 393728
2019-02-18 15:37:12.026980: I tensorflow/core/common_runtime/bfc_allocator.cc:671]      Summary of in-use Chunks by size: 
2019-02-18 15:37:12.027002: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 104 Chunks of size 256 totalling 26.0KiB
2019-02-18 15:37:12.027020: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 18 Chunks of size 512 totalling 9.0KiB
2019-02-18 15:37:12.027040: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 1 Chunks of size 768 totalling 768B
2019-02-18 15:37:12.027057: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 13 Chunks of size 1024 totalling 13.0KiB
2019-02-18 15:37:12.027077: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 1 Chunks of size 1280 totalling 1.2KiB
2019-02-18 15:37:12.027097: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 1 Chunks of size 4608 totalling 4.5KiB
2019-02-18 15:37:12.027114: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 1 Chunks of size 9216 totalling 9.0KiB
2019-02-18 15:37:12.027134: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 1 Chunks of size 12544 totalling 12.2KiB
2019-02-18 15:37:12.027154: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 4 Chunks of size 16384 totalling 64.0KiB
2019-02-18 15:37:12.027181: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 5 Chunks of size 37632 totalling 183.8KiB
2019-02-18 15:37:12.027203: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 3 Chunks of size 294912 totalling 864.0KiB
2019-02-18 15:37:12.027223: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 1 Chunks of size 393728 totalling 384.5KiB
2019-02-18 15:37:12.027242: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 2 Chunks of size 1179648 totalling 2.25MiB
2019-02-18 15:37:12.027260: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 1 Chunks of size 1360128 totalling 1.30MiB
2019-02-18 15:37:12.027291: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 3 Chunks of size 2097152 totalling 6.00MiB
2019-02-18 15:37:12.027311: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 2 Chunks of size 16777216 totalling 32.00MiB
2019-02-18 15:37:12.027331: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 3 Chunks of size 33554432 totalling 96.00MiB
2019-02-18 15:37:12.027351: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 1 Chunks of size 34611200 totalling 33.01MiB
2019-02-18 15:37:12.027371: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 1 Chunks of size 66052096 totalling 62.99MiB
2019-02-18 15:37:12.027391: I tensorflow/core/common_runtime/bfc_allocator.cc:674] 1 Chunks of size 68161536 totalling 65.00MiB
2019-02-18 15:37:12.027411: I tensorflow/core/common_runtime/bfc_allocator.cc:678] Sum Total of in-use chunks: 300.09MiB
2019-02-18 15:37:12.027434: I tensorflow/core/common_runtime/bfc_allocator.cc:680] Stats: 
Limit:                 10917337498
InUse:                   314663168
MaxInUse:               2582638592
NumAllocs:                     250
MaxAllocSize:           2233466880

2019-02-18 15:37:12.027474: W tensorflow/core/common_runtime/bfc_allocator.cc:279] __________________________________________________________________________________________**____****
2019-02-18 15:37:12.027550: W tensorflow/core/framework/op_kernel.cc:1318] OP_REQUIRES failed at batch_matmul_op_impl.h:489 : Resource exhausted: OOM when allocating tensor with shape[2,65536,65536] and type float on /job:localhost/replica:0/task:0/device:GPU:2 by allocator GPU_2_bfc
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py", line 1322, in _do_call
    return fn(*args)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py", line 1307, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py", line 1409, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[2,65536,65536] and type float on /job:localhost/replica:0/task:0/device:GPU:2 by allocator GPU_2_bfc
	 [[Node: generator/decoder/attention_1/MatMul = BatchMatMul[T=DT_FLOAT, _class=["loc:@gener...d/MatMul_1"], adj_x=false, adj_y=true, _device="/job:localhost/replica:0/task:0/device:GPU:2"](generator/decoder/attention_1/Reshape, generator/decoder/attention_1/Reshape_1, ^swap_out_generator_train/gradients/generator/decoder/attention_1/MatMul_grad/MatMul_1_1, ^swap_out_generator_train/gradients/generator/decoder/attention_1/MatMul_grad/MatMul_1)]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.

	 [[Node: generator/decoder/Tanh/_941 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device="/job:localhost/replica:0/task:0/device:GPU:2", send_device_incarnation=1, tensor_name="edge_3239_generator/decoder/Tanh", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "p2p_att.py", line 1272, in <module>
    main()
  File "p2p_att.py", line 1232, in main
    results = sess.run(fetches, options=options, run_metadata=run_metadata)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py", line 900, in run
    run_metadata_ptr)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py", line 1135, in _run
    feed_dict_tensor, options, run_metadata)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py", line 1316, in _do_run
    run_metadata)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py", line 1335, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[2,65536,65536] and type float on /job:localhost/replica:0/task:0/device:GPU:2 by allocator GPU_2_bfc
	 [[Node: generator/decoder/attention_1/MatMul = BatchMatMul[T=DT_FLOAT, _class=["loc:@gener...d/MatMul_1"], adj_x=false, adj_y=true, _device="/job:localhost/replica:0/task:0/device:GPU:2"](generator/decoder/attention_1/Reshape, generator/decoder/attention_1/Reshape_1, ^swap_out_generator_train/gradients/generator/decoder/attention_1/MatMul_grad/MatMul_1_1, ^swap_out_generator_train/gradients/generator/decoder/attention_1/MatMul_grad/MatMul_1)]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.

	 [[Node: generator/decoder/Tanh/_941 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device="/job:localhost/replica:0/task:0/device:GPU:2", send_device_incarnation=1, tensor_name="edge_3239_generator/decoder/Tanh", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.


Caused by op 'generator/decoder/attention_1/MatMul', defined at:
  File "p2p_att.py", line 1272, in <module>
    main()
  File "p2p_att.py", line 1084, in main
    model = create_model(examples.inputs, examples.targets)
  File "p2p_att.py", line 820, in create_model
    outputs = create_generator_resgan(inputs, out_channels)
  File "p2p_att.py", line 313, in create_generator_resgan
    input_channel=a.ngf, flag_condition=False, channel_fac=a.channel_fac, scope='attention_1')
  File "/gdata/liyh/project/e2p/ops.py", line 112, in selfatt
    s = tf.matmul(hw_flatten(g), hw_flatten(f), transpose_b=True) # # [bs, N, N]
  File "/usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/math_ops.py", line 2084, in matmul
    a, b, adj_x=adjoint_a, adj_y=adjoint_b, name=name)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/gen_math_ops.py", line 1236, in batch_mat_mul
    "BatchMatMul", x=x, y=y, adj_x=adj_x, adj_y=adj_y, name=name)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/ops.py", line 3392, in create_op
    op_def=op_def)
  File "/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/ops.py", line 1718, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

ResourceExhaustedError (see above for traceback): OOM when allocating tensor with shape[2,65536,65536] and type float on /job:localhost/replica:0/task:0/device:GPU:2 by allocator GPU_2_bfc
	 [[Node: generator/decoder/attention_1/MatMul = BatchMatMul[T=DT_FLOAT, _class=["loc:@gener...d/MatMul_1"], adj_x=false, adj_y=true, _device="/job:localhost/replica:0/task:0/device:GPU:2"](generator/decoder/attention_1/Reshape, generator/decoder/attention_1/Reshape_1, ^swap_out_generator_train/gradients/generator/decoder/attention_1/MatMul_grad/MatMul_1_1, ^swap_out_generator_train/gradients/generator/decoder/attention_1/MatMul_grad/MatMul_1)]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.

	 [[Node: generator/decoder/Tanh/_941 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device="/job:localhost/replica:0/task:0/device:GPU:2", send_device_incarnation=1, tensor_name="edge_3239_generator/decoder/Tanh", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.


